<style>
  body { font-family: sans-serif; background: #19262f; }
  h1 { color: white;}
  a, a:hover, a:focus { color: #E2574B }
  ol { list-style: none; border-left: 2px solid rgba(255, 255, 255, 0.3); padding: 10px; margin: 10px; }
  li { padding: 10px; }
</style>
<h1>NPR Songs We Love 2014 Bookmarklets</h1>
<ol>
  <li><a href="javascript:(function() {  var ls = window.localStorage;  var storageKey = 'heart-tracks';  var songs = $('.songs:first');  var track = {    song        : $('.player h1.song-title').text(),    artist      : $('.player h2.artist').text(),    contributor : songs.find('.song:last .byline .name').text(),    links: {      amazon  : songs.find('.song:last .song-tools .amazon').attr('href'),      itunes   : songs.find('.song:last .song-tools .itunes').attr('href'),      rdio    : songs.find('.song:last .song-tools .rdio').attr('href'),      spotify : songs.find('.song:last .song-tools .spotify').attr('href')    }  };  var hearts = ls.getItem(storageKey);  hearts = hearts ? JSON.parse(hearts) : {};  hearts[track.song + '-' + track.artist] = track;  ls.setItem(storageKey, JSON.stringify(hearts));  /* Add a heart to the screen! */  $('<img>')    .attr('src', 'http://upload.wikimedia.org/wikipedia/commons/4/42/Love_Heart_SVG.svg')    .css({      position  : 'fixed',      top       : '50%',      left      : '50%',      transform : 'translate(-50%, -50%)',      /* this just makes the red heart white */      filter           : 'grayscale(1) brightness(10)',      '-webkit-filter' : 'grayscale(1) brightness(10)'    })    .appendTo('body')    .fadeOut(400, function() {      $(this).remove();    });})();">NPR Love</a></li>
  <li><a href="javascript:(function() {  var ls = window.localStorage;  var storageKey = 'hate-tracks';  var songs = $('.songs:first');  var track = {    song        : $('.player h1.song-title').text(),    artist      : $('.player h2.artist').text(),    contributor : songs.find('.song:last .byline .name').text(),    links: {      amazon  : songs.find('.song:last .song-tools .amazon').attr('href'),      itunes   : songs.find('.song:last .song-tools .itunes').attr('href'),      rdio    : songs.find('.song:last .song-tools .rdio').attr('href'),      spotify : songs.find('.song:last .song-tools .spotify').attr('href')    }  };  var hates = ls.getItem(storageKey);  hates = hates ? JSON.parse(hates) : {};  hates[track.song + '-' + track.artist] = track;  ls.setItem(storageKey, JSON.stringify(hates));  /* Add a heart to the screen! */  $('<img>')    .attr('src', 'http://upload.wikimedia.org/wikipedia/en/b/ba/Red_x.svg')    .css({      position  : 'fixed',      top       : '50%',      left      : '50%',      transform : 'translate(-50%, -50%)',      /* this just makes the red heart white */      filter           : 'grayscale(1) brightness(10)',      '-webkit-filter' : 'grayscale(1) brightness(10)'    })    .appendTo('body')    .fadeOut(400, function() {      $(this).remove();    });})();">NPR Hate</a></li>
  <li><a href="javascript:(function() {  var panels = $('.save-list');  if (panels.length) {    panels.remove();    return;  }  var ls = window.localStorage;  var heartTracks = JSON.parse(ls.getItem('heart-tracks') || '{}');  var hateTracks  = JSON.parse(ls.getItem('hate-tracks') || '{}');  var heartTracksArr = Object.keys(heartTracks).map(values(heartTracks));  var hateTracksArr  = Object.keys(hateTracks).map(values(hateTracks));  var trackTemplate = template(function() {/*    <div class='song small' style='background:#0B0E13;border-bottom:2px solid #2F4C5A;'>      <div class='container-fluid'>        <div class='song-info'>          <div class='song-info-wrapper'>            <h2 class='artist'>{artist} <span class='tag-header'>(from {contributor})</span></h2>            <h1 style='color:white' class='song-title'>{song}</h1>            <ul class='song-tools list-unstyled'>              [links.amazon? <li><a target='_blank' href='{links.amazon}' class='amazon'><span class='icon-amazon'></span></a> ]              [links.itunes? <li><a target='_blank' href='{links.itunes}' class='itunes'><span class='icon-apple'></span></a> ]              [links.rdio? <li><a target='_blank' href='{links.rdio}' class='rdio'><span class='icon-rdio'></span></a> ]              [links.spotify? <li><a target='_blank' href='{links.spotify}' class='spotify'><span class='icon-spotify-circled'></span></a> ]            </ul>          </div>        </div>      </div>    </div>  */});  var panelTemplate = template(function() {/*    <div style='width:100%; background:black'>      <h1 style='color:white;padding:20px'>{title}</h1>      {content}    </div>  */});  var heartPanelContent = templateCompile(panelTemplate, {    content : heartTracksArr.map(compileTrack).join(''),    title   : 'Heart Tracks'  });  var positioningCSS = {    position : 'fixed',    top      : '4rem',    height   : 'calc(100% - 13rem)',    width    : '100%',    overflow : 'auto'  };  var heartPanel = $('<div class=\'heart-list save-list\'>')    .html(heartPanelContent)    .css(positioningCSS)    .css('left', 0)    .appendTo('body');  function values(obj) {    return function(key) {      return obj[key];    };  }  function template(fn) {    return fn.toString().replace(/\n/g, '').match(/\/\*(.*?)\*\//)[1];  }  function compileTrack(track) {    return templateCompile(trackTemplate, track);  }  function templateCompile(template, props) {    /* handle conditionals */    template = template.replace(/\[(.+?)\?(.*?)\]/g, function(str, prop, tmpl) {      return getProp(props, prop) ? tmpl : '';    });    /* handle substitutions */    template = template.replace(/\{(.+?)\}/g, function(str, prop) {      return getProp(props, prop);    });    return template;  }  function getProp(obj, prop) {    var propChain = prop.split('.');    var val = obj;    for (var i = 0, len = propChain.length; i < len; i++) {      var newVal = val[propChain[i]];      if (newVal) {        val = val[propChain[i]];      } else {        return null;      }    }    return val;  }})();">NPR Love List</a></li>
  <li><a href="javascript:(function() {  var panels = $('.save-list');  if (panels.length) {    panels.remove();    return;  }  var ls = window.localStorage;  var hateTracks  = JSON.parse(ls.getItem('hate-tracks') || '{}');  var hateTracksArr  = Object.keys(hateTracks).map(values(hateTracks));  var trackTemplate = template(function() {/*    <div class='song small' style='background:#0B0E13;border-bottom:2px solid #2F4C5A;'>      <div class='container-fluid'>        <div class='song-info'>          <div class='song-info-wrapper'>            <h2 class='artist'>{artist} <span class='tag-header'>(from {contributor})</span></h2>            <h1 style='color:white' class='song-title'>{song}</h1>            <ul class='song-tools list-unstyled'>              [links.amazon? <li><a target='_blank' href='{links.amazon}' class='amazon'><span class='icon-amazon'></span></a> ]              [links.itunes? <li><a target='_blank' href='{links.itunes}' class='itunes'><span class='icon-apple'></span></a> ]              [links.rdio? <li><a target='_blank' href='{links.rdio}' class='rdio'><span class='icon-rdio'></span></a> ]              [links.spotify? <li><a target='_blank' href='{links.spotify}' class='spotify'><span class='icon-spotify-circled'></span></a> ]            </ul>          </div>        </div>      </div>    </div>  */});  var panelTemplate = template(function() {/*    <div style='width:100%; background:black'>      <h1 style='color:white;padding:20px'>{title}</h1>      {content}    </div>  */});  var hatePanelContent  = templateCompile(panelTemplate, {    content : hateTracksArr.map(compileTrack).join(''),    title   : 'Hate Tracks'  });  var positioningCSS = {    position : 'fixed',    top      : '4rem',    height   : 'calc(100% - 13rem)',    width    : '100%',    overflow : 'auto'  };  var hatePanel  = $('<div class=\'hate-list save-list\'>')    .html(hatePanelContent)    .css(positioningCSS)    .css('right', 0)    .appendTo('body');  function values(obj) {    return function(key) {      return obj[key];    };  }  function template(fn) {    return fn.toString().replace(/\n/g, '').match(/\/\*(.*?)\*\//)[1];  }  function compileTrack(track) {    return templateCompile(trackTemplate, track);  }  function templateCompile(template, props) {    /* handle conditionals */    template = template.replace(/\[(.+?)\?(.*?)\]/g, function(str, prop, tmpl) {      return getProp(props, prop) ? tmpl : '';    });    /* handle substitutions */    template = template.replace(/\{(.+?)\}/g, function(str, prop) {      return getProp(props, prop);    });    return template;  }  function getProp(obj, prop) {    var propChain = prop.split('.');    var val = obj;    for (var i = 0, len = propChain.length; i < len; i++) {      var newVal = val[propChain[i]];      if (newVal) {        val = val[propChain[i]];      } else {        return null;      }    }    return val;  }})();">NPR Hate List</a></li>
</ol>
